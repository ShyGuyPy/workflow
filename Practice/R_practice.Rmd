---
title: "R practice"
author: "Luke Vawter"
date: "September 18, 2018"
output: html_document
---

factors in R:
https://swcarpentry.github.io/r-novice-inflammation/12-supp-factors/
not char or string,
they are integers and behave as such
```{r}
library(magrittr)

fruits <- factor(c("grape", "bananna", "grape", "bananna", "apple", "orange"))
#sets order of factor levels
fruits <- factor(fruits, levels = c("orange", "grape", "bananna", "apple"), ordered = TRUE)
levels(fruits)
nlevels(fruits)

fruits %>%
  trimws() %>%
  print()

```

trimws():
```{r}
library(magrittr)

thing <- " this is a test   "
print(trimws(thing))
#and again using pipes
thing %>% 
  trimws() %>%
  print()

```
playing with select, filter,     :
```{r}
library(magrittr)
library(readxl)
library(dplyr)

#project.dir in dplyr
toy.df <- read_excel(file.path(project.dir, "data/jackie_data/Data 2013_4plus-phyto-metrics.xlsx"),
                         sheet = "DATA_4+biometrics",
                         skip = 1)

#colnames(toy.df)

new.toy.df <- toy.df %>%
  #include only those columns starting with s
  select(starts_with("s")) %>%
  
  #only include rows which fall within given ranges
  filter(SURVEY_ID <= 30867, SALINITY < 6) %>%
  #select(SURVEY_ID:SAMPLE_DATE) %>
  
  #arrange in descending order based on SURVEY_ID value
  arrange(desc(SURVEY_ID)) %>%
  print()

mutant.toy.df <- toy.df %>%
  
  mutate(nonsense=SECCHI/SALINITY) %>%
  print()
  
#also could do group_by()
```

```{r}
library(magrittr)

toy.df <- read_excel(file.path(project.dir, "data/jackie_data/Data 2013_4plus-phyto-metrics.xlsx"),
                         sheet = "DATA_4+biometrics",
                         skip = 1)

toy.df %>%
  select(PIBI_Rank) %>%
  print()


```

http://r4ds.had.co.nz/data-visualisation.html
working through "R for Data Science", a resource Zach linked.  Plenty of it I'm familiar with, but I'm finding my data scientist skills could use some work so I'm doing some review:
```{r}
library(ggplot2)
library(magrittr)
# cars.df <- ggplot2::mpg
# print(cars.df)

cars.columns.df <- ggplot2::mpg %>%
  colnames() %>%
  print()

ggplot(data = mpg) +
  geom_point(mapping = aes(x = displ, y = hwy, color = class, shape = drv))

ggplot(data = mpg) +
  geom_point(mapping = aes(x = cyl, y = hwy, color = class, shape = drv))




```
using str_replace_all func:
```{r}
library(ggplot2)
library(magrittr)

spaces <-c("hi here", "I'm tired","need a break")
snakes <- spaces %>%
  str_replace_all(" ", "_") %>%
  print()
```

show number of rows and coumns:
```{r}
nrow(mpg)
ncol(mpg)
```

how to apply an aesthetic to the whole plot
```{r}
library(ggplot2)

ggplot(data = mpg) + 
  geom_point(mapping = aes(x = displ, y = hwy), color = "blue")

```

facets can be used to break the above scaterplot into separate visualizations.  In this case the data is divided by the class of the car. What we end up with is clusters of data because car class(class) and engine size(displ) are tightly related.Also, we can see distinct sections of the downward trend of the data as engine size increases, hgihtlighting the negative relationship between engine size and highway miles per gallon(hwy).:
```{r}
library(ggplot2)


ggplot(data = mpg)+
  geom_point(mapping = aes(x=displ, y = hwy))+
  facet_wrap(~class, nrow = 2)

```


adding more than one geom:
```{r}
library(ggplot2)

ggplot(data = mpg)+
  geom_smooth(mapping = aes(x=displ, y= hwy,linetype=drv, color=drv))+
  geom_point(mapping = aes(x=displ, y= hwy, color=drv))
```

gloabl geom plotting:
```{r}
ggplot(data=mpg, mapping = aes(x=displ,y=hwy))+
  geom_line(color="blue")+
  geom_point(mapping =aes(color = class))+
  geom_smooth()
  
```

```{r}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy, color = drv)) + 
  geom_point() + 
  geom_smooth(se=FALSE)
```

```{r}
ggplot(data = mpg, mapping = aes(x = displ, y = hwy))+
  geom_point(mapping=aes(color=drv))+
  geom_smooth(mapping=aes(linetype=drv),se=FALSE)+
  coord_flip()
```

summary I don't fully get or see the value of but here it is:
```{r}
library(ggplot2)
ggplot(data= mpg)+
  stat_summary(
    mapping = aes(x = displ, y = hwy),
    fun.ymin = min,
    fun.ymax = max,
    fun.y = median
  )
```


position values of identity, dodge, and fill(below) alter the presentation of the data:
```{r}
ggplot(data = diamonds, mapping = aes(x=cut, fill = clarity))+
  geom_bar(alpha = 3/5, position= "fill" )
```

The use of jitter in a scatterplot fixes the problem of overplotting cuased by rounding of values.  Here we can see the clustering various points(such as position 4.7, 5 or 2.8,20).  The desnity of the blob gies us a sense of how many points land at approximately the same axis point
```{r}
ggplot(data=mpg)+
  geom_point(mapping=aes(x=displ,y=hwy), position ="jitter")
```

coxcomb chart:
```{r}
library(ggplot2)

assigned <- ggplot(data=mpg, mapping = aes(x=drv, fill =drv))+
  geom_bar(width=1)+
  theme(aspect.ratio = 1)+
  labs(x = NULL, y =NULL)


assigned + coord_polar() #+ coord_flip()
  
```

"The grammar of graphics is based on the insight that you can uniquely describe any plot as a combination of a dataset, a geom, a set of mappings, a stat, a position adjustment, a coordinate system, and a faceting scheme."


```{r}
graph_components <- c("dataset", "geom", "set of mappings", "a stat", "postion", "coordinate system", "faceting scheme" )


# for (component in graph_components){
#   print(component)
# }
```
